group_by(recipient_region) %>%
summarise(pct_region = total/sum(total)*100)
finance_tree %>%
group_by(recipient_region) %>%
mutate(pct_region = total/sum(total)*100)
finance_tree <- finance_tree %>%
group_by(recipient_region) %>%
mutate(pct_region = total/sum(total)*100)
finance_tree <- finance_tree %>%
group_by(recipient_region, crs_sector_name) %>%
mutate(pct_region = total/sum(total)*100)
finance_tree <- finance_tree %>%
group_by(crs_sector_name) %>%
mutate(pct_region = total/sum(total)*100)
finance_tree <- finance_tree %>%
group_by(crs_sector_name) %>%
mutate(pct_region = total/sum(total)*100, ave = sum(pct_region))
finance_tree <- finance_tree %>%
group_by(crs_sector_name) %>%
mutate(pct_region = total/sum(total)*100)
ggplotly(ggplot(finance_tree) +
geom_bar(aes(pct_region, crs_sector_name, fill = recipient_region),
stat= "identity", position = "fill") +
labs(title = "Chinese development finance per type and continent",
y = "", x = "Total", fill = "Region") +
theme_minimal() +
theme(title = element_text(face = "bold"),
legend.position = "bottom"))
finance_tree <- finance_tree %>%
group_by(crs_sector_name) %>%
mutate(pct_region = total*100/sum(total))
ggplotly(ggplot(finance_tree) +
geom_bar(aes(pct_region, crs_sector_name, fill = recipient_region),
stat= "identity", position = "fill") +
labs(title = "Chinese development finance per type and continent",
y = "", x = "Total", fill = "Region") +
theme_minimal() +
theme(title = element_text(face = "bold"),
legend.position = "bottom"))
finance_tree <- finance_tree %>%
group_by(crs_sector_name) %>%
mutate(total_por_tema = sum(total))
debt_stock <- read.csv("debt_stock_china.csv") %>%
select(-country_code, -ISO)
comtrade <- rbind(read.csv("comtrade_2018.csv"), read.csv("comtrade_2013.csv"),
read.csv("comtrade_2008.csv"), read.csv("comtrade_2003.csv"))
comtrade_china_total <- comtrade %>%
select(Year, Trade.Flow, Partner, Partner.ISO, Trade.Value..US..) %>%
rename(year = Year, trade_flow = Trade.Flow, country = Partner, ISO = Partner.ISO, total_usd = Trade.Value..US..) %>%
pivot_wider(names_from = "trade_flow", values_from = "total_usd") %>%
filter(country != "World")
worlde <- world %>%
rename(country = name_long)
mapamundi <- left_join(worlde, debt_stock, by = "country") %>%
left_join(comtrade_china_total, by = c("country", "year"))
library(shiny)
library(maps)
worlde <- world %>%
rename(country = name_long)
library(sf)
library(spData)
library(lubridate)
worlde <- world %>%
rename(country = name_long)
debt_stock <- read.csv("debt_stock_china.csv") %>%
select(-country_code, -ISO)
comtrade <- rbind(read.csv("comtrade_2018.csv"), read.csv("comtrade_2013.csv"),
read.csv("comtrade_2008.csv"), read.csv("comtrade_2003.csv"))
comtrade_china_total <- comtrade %>%
select(Year, Trade.Flow, Partner, Partner.ISO, Trade.Value..US..) %>%
rename(year = Year, trade_flow = Trade.Flow, country = Partner, ISO = Partner.ISO, total_usd = Trade.Value..US..) %>%
pivot_wider(names_from = "trade_flow", values_from = "total_usd") %>%
filter(country != "World")
worlde <- world %>%
rename(country = name_long)
mapamundi <- left_join(worlde, debt_stock, by = "country") %>%
left_join(comtrade_china_total, by = c("country", "year"))
View(mapamundi)
finance <- read.csv("chinese_finance.csv")
finance$usd_defl_2014 <- str_remove_all(finance$usd_defl_2014, ",")
finance$usd_defl_2014 <- as.integer(finance$usd_defl_2014)
finance_tree <- finance %>%
group_by(recipient_region, crs_sector_name) %>%
summarise(total = sum(usd_defl_2014, na.rm = TRUE))
finance_tree <- finance_tree %>%
group_by(crs_sector_name) %>%
mutate(pct_region = total*100/sum(total))
finance_tree <- finance_tree %>%
group_by(crs_sector_name) %>%
mutate(pct_region = total*100/sum(total)) %>%
select(-total)
finance %>%
group_by(recipient_condensed, recipient_region) %>%
summarize(n = n())
countries_regions <- finance %>%
group_by(recipient_condensed, recipient_region) %>%
summarize(n = n()) %>%
select(-n)
View(countries_regions)
countries_regions <- finance %>%
group_by(recipient_condensed, recipient_region) %>%
summarize(n = n()) %>%
select(-n) %>%
rename(country = 1)
anti_join(mapamundi, countries_regions, by = "country")
que <- anti_join(mapamundi, countries_regions, by = "country")
View(countries_regions)
View(que)
?renderPlotly
runApp()
runApp()
finance %>%
group_by(year, crs_sector_name) %>%
summarise(total = sum(usd_defl_2014, na.rm = TRUE)/1000000) %>%
ungroup() %>%
group_by(crs_sector_name) %>%
mutate(totaltotal = sum(total)) %>%
filter(totaltotal > 10000 & crs_sector_name != "Unallocated / Unspecified") %>%
ggplot() +
geom_line(aes(year, total, color = crs_sector_name), size = 1, stat = "identity") +
theme_minimal() +
labs(title = "Evolution of chinese finance per most relevant sector (2000-2017)",
x = "", y = "Millions of USD (2014)", color = "Sector")  +
theme(title = element_text(face = "bold"))
trade_debt_gdp %>%
group_by(continent, year) %>%
summarise(total = sum(total_usd, na.rm = TRUE)) %>%
ggplot() +
geom_line(aes(year, total, color = continent), stat = "identity") +
theme_minimal() +
labs(title = "Evolution of chinese trade per continent (2000-2017)",
x = "", y = "Total in USD", color = "Continent")
gdp <- WDI(indicator='NY.GDP.PCAP.KD', start=2000, end=2017) %>%
rename(gdp_per_capita = 3) %>%
select(country, gdp_per_capita, year)
trade_debt_gdp <- left_join(trade_debt, gdp, by = c("country", "year"))
## nothing interesting to show here
trade_debt_gdp %>%
filter(china_debt_gdp < 60 & gdp_per_capita < 30000) %>%
ggplot() +
geom_point(aes(gdp_per_capita, total_usd), stat = "identity") +
geom_smooth(aes(gdp_per_capita, total_usd))
trade_debt_gdp %>%
group_by(continent, year) %>%
summarise(total = sum(total_usd, na.rm = TRUE)) %>%
ggplot() +
geom_line(aes(year, total, color = continent), stat = "identity") +
theme_minimal() +
labs(title = "Evolution of chinese trade per continent (2000-2017)",
x = "", y = "Total in USD", color = "Continent")
debt %>%
group_by(year) %>%
summarise(total = sum(debt_usd, na.rm = TRUE)) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total - lag(total),
growth_rate = (diff_growth / diff_year)/lag(total) * 100) %>%
ggplot() +
geom_line(aes(year, growth_rate), stat = "identity") +
theme(legend.position = "none")
debt %>%
group_by(year) %>%
summarise(total = sum(debt_usd, na.rm = TRUE)) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total - lag(total),
growth_rate = (diff_growth / diff_year)/lag(total) * 100) #%>%
ggplot() +
geom_line(aes(year, growth_rate), stat = "identity") +
theme(legend.position = "none") +
theme_minimal()
library(tidyverse)
library(countrycode)
library(gapminder)
library(stargazer)
library(WDI)
library(plotly)
c_f <- read.csv("chinese_finance.csv")
c_pd <- read.csv("chinese_public_diplo.csv")
debt <- read.csv("debt_stock_china.csv")
debt$debt_usd <- str_remove_all(debt$debt_usd, ",")
debt$debt_usd <- as.integer(debt$debt_usd)
debt$continent <- countrycode(sourcevar = debt$country,
origin = "country.name",
destination = "continent")
visits <- c_pd %>%
rename(country = 1) %>%
select(country, year, total_elite_visits) %>%
inner_join(debt, by = c("country", "year"))
ggplot(visits) +
geom_point(aes(debt_usd, total_elite_visits), stat = "identity")
debt %>%
group_by(year, continent) %>%
summarise(total = sum(debt_usd, na.rm = TRUE)/1000000) %>%
ggplot() +
geom_line(aes(year, total, color = continent), stat = "identity") +
theme_minimal() +
labs(title = "Evolution of chinese finance per continent (2000-2017)",
x = "", y = "Millions of USD", color = "Continent")  +
theme(title = element_text(face = "bold"))
debt %>%
group_by(year) %>%
summarise(total = sum(debt_usd, na.rm = TRUE)) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total - lag(total),
growth_rate = (diff_growth / diff_year)/lag(total) * 100) #%>%
debt %>%
group_by(year) %>%
summarise(total = sum(debt_usd, na.rm = TRUE)) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total - lag(total),
growth_rate = (diff_growth / diff_year)/lag(total) * 100) %>%
ggplot() +
geom_line(aes(year, growth_rate), stat = "identity") +
theme(legend.position = "none") +
theme_minimal()
debt %>%
group_by(year) %>%
summarise(total = sum(debt_usd, na.rm = TRUE)) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total - lag(total),
growth_rate = (diff_growth / diff_year)/lag(total) * 100) %>%
ggplot() +
geom_line(aes(year, growth_rate), color = "brown", stat = "identity") +
theme(legend.position = "none") +
theme_minimal()
debt %>%
group_by(year) %>%
summarise(total = sum(debt_usd, na.rm = TRUE)) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total - lag(total),
growth_rate = (diff_growth / diff_year)/lag(total) * 100) %>%
ggplot() +
geom_line(aes(year, growth_rate), color = "brown", size = 1, stat = "identity") +
theme(legend.position = "none") +
theme_minimal() +
labs(title = "Growth rate of total investments from China", y = "Growth Rate (%)", x = "",
caption = "Source: Horn, Sebastian, Carmen M. Reinhart, and Christoph Trebesch. 2019. 'China's Overseas Lending.' NBER Working Paper No. 26050.")
debt %>%
group_by(year) %>%
summarise(total = sum(debt_usd, na.rm = TRUE)) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total - lag(total),
growth_rate = (diff_growth / diff_year)/lag(total) * 100) %>%
ggplot() +
geom_line(aes(year, growth_rate), color = "brown", size = 1, stat = "identity") +
theme(legend.position = "none", title = element_text(face = "bold", family = "Times New Roman")) +
theme_minimal() +
labs(title = "Growth rate of total investments from China", y = "Growth Rate (%)", x = "",
caption = "Source: Horn, Sebastian, Carmen M. Reinhart, and Christoph Trebesch. 2019. 'China's Overseas Lending.' NBER Working Paper No. 26050.")
debt %>%
group_by(year) %>%
summarise(total = sum(debt_usd, na.rm = TRUE)) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total - lag(total),
growth_rate = (diff_growth / diff_year)/lag(total) * 100) %>%
ggplot() +
geom_line(aes(year, growth_rate), color = "brown", size = 1, stat = "identity") +
theme(legend.position = "none", title = element_text(face = "bold", family = "Times New Roman")) +
theme_minimal() +
labs(title = "Growth rate of total investments from China", y = "Growth Rate (%)", x = "",
caption = "Source: Horn, Sebastian, Carmen M. Reinhart, and Christoph Trebesch. 2019. 'China's Overseas Lending.' NBER Working Paper No. 26050.")
debt %>%
group_by(year) %>%
summarise(total = sum(debt_usd, na.rm = TRUE)) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total - lag(total),
growth_rate = (diff_growth / diff_year)/lag(total) * 100) %>%
ggplot() +
geom_line(aes(year, growth_rate), color = "brown", size = 1, stat = "identity") +
theme(legend.position = "none", title = element_text(face = "bold", family = "Arial")) +
theme_minimal() +
labs(title = "Growth rate of total investments from China", y = "Growth Rate (%)", x = "",
caption = "Source: Horn, Sebastian, Carmen M. Reinhart, and Christoph Trebesch. 2019. 'China's Overseas Lending.' NBER Working Paper No. 26050.")
?element_text
debt %>%
group_by(year) %>%
summarise(total = sum(debt_usd, na.rm = TRUE)) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total - lag(total),
growth_rate = (diff_growth / diff_year)/lag(total) * 100) %>%
ggplot() +
geom_line(aes(year, growth_rate), color = "brown", size = 1, stat = "identity") +
theme(legend.position = "none", title = element_text(face = "bold", family = "Times")) +
theme_minimal() +
labs(title = "Growth rate of total investments from China", y = "Growth Rate (%)", x = "",
caption = "Source: Horn, Sebastian, Carmen M. Reinhart, and Christoph Trebesch. 2019. 'China's Overseas Lending.' NBER Working Paper No. 26050.")
debt %>%
group_by(year) %>%
summarise(total = sum(debt_usd, na.rm = TRUE)) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total - lag(total),
growth_rate = (diff_growth / diff_year)/lag(total) * 100) %>%
ggplot() +
geom_line(aes(year, growth_rate), color = "brown", size = 1, stat = "identity") +
theme_minimal() +
labs(title = "Growth rate of total investments from China", y = "Growth Rate (%)", x = "",
caption = "Source: Horn, Sebastian, Carmen M. Reinhart, and Christoph Trebesch. 2019. 'China's Overseas Lending.' NBER Working Paper No. 26050.") +
theme(legend.position = "none",
title = element_text(face = "bold", family = "Times"))
debt %>%
group_by(year) %>%
summarise(total = sum(debt_usd, na.rm = TRUE)) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total - lag(total),
growth_rate = (diff_growth / diff_year)/lag(total) * 100) %>%
ggplot() +
geom_line(aes(year, growth_rate), color = "brown", size = 1, stat = "identity") +
theme_minimal() +
labs(title = "Growth rate of total investments from China", y = "Growth Rate (%)", x = "",
caption = "Source: Horn, Sebastian, Carmen M. Reinhart, and Christoph Trebesch. 2019. 'China's Overseas Lending.' NBER Working Paper No. 26050.") +
theme(legend.position = "none",
title = element_text(face = "bold", family = "Courier"))
debt %>%
group_by(year) %>%
summarise(total = sum(debt_usd, na.rm = TRUE)) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total - lag(total),
growth_rate = (diff_growth / diff_year)/lag(total) * 100) %>%
ggplot() +
geom_line(aes(year, growth_rate), color = "brown", size = 1, stat = "identity") +
theme_minimal() +
labs(title = "Growth rate of total investments from China", y = "Growth Rate (%)", x = "",
caption = "Source: Horn, Sebastian, Carmen M. Reinhart, and Christoph Trebesch. 2019. 'China's Overseas Lending.' NBER Working Paper No. 26050.") +
theme(legend.position = "none",
plot.title = element_text(face = "bold", family = "Courier"))
debt %>%
group_by(year) %>%
summarise(total = sum(debt_usd, na.rm = TRUE)) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total - lag(total),
growth_rate = (diff_growth / diff_year)/lag(total) * 100) %>%
ggplot() +
geom_line(aes(year, growth_rate), color = "brown", size = 1, stat = "identity") +
theme_minimal() +
labs(title = "Growth rate of total investments from China", y = "Growth Rate (%)", x = "",
caption = "Source: Horn, Sebastian, Carmen M. Reinhart, and Christoph Trebesch. 2019. 'China's Overseas Lending.' NBER Working Paper No. 26050.") +
theme(legend.position = "none",
plot.title = element_text(face = "bold", family = "Times"))
windowsFonts()
debt %>%
group_by(year) %>%
summarise(total = sum(debt_usd, na.rm = TRUE)) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total - lag(total),
growth_rate = (diff_growth / diff_year)/lag(total) * 100) %>%
ggplot() +
geom_line(aes(year, growth_rate), color = "brown", size = 1, stat = "identity") +
theme_minimal() +
labs(title = "Growth rate of total investments from China", y = "Growth Rate (%)", x = "",
caption = "Source: Horn, Sebastian, Carmen M. Reinhart, and Christoph Trebesch. 2019. 'China's Overseas Lending.' NBER Working Paper No. 26050.") +
theme(legend.position = "none",
plot.title = element_text(face = "bold", family = "TT Times New Roman"))
debt %>%
group_by(year) %>%
summarise(total = sum(debt_usd, na.rm = TRUE)) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total - lag(total),
growth_rate = (diff_growth / diff_year)/lag(total) * 100) %>%
ggplot() +
geom_line(aes(year, growth_rate), color = "brown", size = 1, stat = "identity") +
theme_minimal() +
labs(title = "Growth rate of total investments from China", y = "Growth Rate (%)", x = "",
caption = "Source: Horn, Sebastian, Carmen M. Reinhart, and Christoph Trebesch. 2019. 'China's Overseas Lending.' NBER Working Paper No. 26050.") +
theme(legend.position = "none",
plot.title = element_text(face = "bold", family = "serif"))
debt %>%
group_by(year) %>%
summarise(total = sum(debt_usd, na.rm = TRUE)) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total - lag(total),
growth_rate = (diff_growth / diff_year)/lag(total) * 100) %>%
ggplot() +
geom_line(aes(year, growth_rate), color = "brown", size = 1, stat = "identity") +
theme_minimal() +
labs(title = "Growth rate of total investments from China", y = "Growth Rate (%)", x = "",
caption = "Source: Horn, Sebastian, Carmen M. Reinhart, and Christoph Trebesch. 2019. 'China's Overseas Lending.' NBER Working Paper No. 26050.") +
theme(legend.position = "none",
plot.title = element_text(face = "bold", family = "serif", size = 16))
debt %>%
group_by(year) %>%
summarise(total = sum(debt_usd, na.rm = TRUE)) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total - lag(total),
growth_rate = (diff_growth / diff_year)/lag(total) * 100) %>%
ggplot() +
geom_line(aes(year, growth_rate), color = "brown", size = 1, stat = "identity") +
theme_minimal() +
labs(title = "Growth rate of total investments from China", y = "Growth Rate (%)", x = "",
caption = "Source: Horn, Sebastian, Carmen M. Reinhart, and Christoph Trebesch. 2019. 'China's Overseas Lending.' NBER Working Paper No. 26050.") +
theme(legend.position = "none",
plot.title = element_text(face = "bold", family = "serif", size = 20))
debt %>%
group_by(year) %>%
summarise(total = sum(debt_usd, na.rm = TRUE)) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total - lag(total),
growth_rate = (diff_growth / diff_year)/lag(total) * 100) %>%
ggplot() +
geom_line(aes(year, growth_rate), color = "brown", size = 1, stat = "identity") +
theme_minimal() +
labs(title = "Growth rate of total investments from China", y = "Growth Rate (%)", x = "",
caption = "Source: Horn, Sebastian, Carmen M. Reinhart, and Christoph Trebesch. 2019. 'China's Overseas Lending.' NBER Working Paper No. 26050.") +
theme(legend.position = "none",
plot.title = element_text(face = "bold", family = "serif", size = 24))
comtrade <- rbind(read.csv("comtrade_2018.csv"), read.csv("comtrade_2013.csv"),
read.csv("comtrade_2008.csv"), read.csv("comtrade_2003.csv"))
comtrade_china_total <- comtrade %>%
select(Year, Trade.Flow, Partner, Partner.ISO, Trade.Value..US..) %>%
rename(year = Year, trade_flow = Trade.Flow, country = Partner, ISO = Partner.ISO, total_usd = Trade.Value..US..) %>%
filter(country != "World")
trade_debt <- debt %>%
select(ISO, year, china_debt_gdp) %>%
right_join(comtrade_china_total, by = c("year", "ISO"))
trade_debt$continent <- countrycode(sourcevar = trade_debt$country,
origin = "country.name",
destination = "continent")
trade_debt %>%
filter(china_debt_gdp < 50) %>%
ggplot() +
geom_point(aes(log(total_usd), china_debt_gdp), stat = "identity") +
geom_smooth(aes(log(total_usd), china_debt_gdp))
reg <- lm(data = trade_debt, china_debt_gdp ~ total_usd + continent)
stargazer(reg, title = "Results", type = "text")
africa <- trade_debt %>%
filter(continent == "Africa")
reg_africa <- lm(data = africa, china_debt_gdp ~ total_usd)
stargazer(reg_africa, title = "Results", type = "text")
finance <- read.csv("chinese_finance.csv")
finance$usd_defl_2014 <- str_remove_all(finance$usd_defl_2014, ",")
finance$usd_defl_2014 <- as.integer(finance$usd_defl_2014)
finance_tree <- finance %>%
group_by(recipient_region, crs_sector_name) %>%
summarise(total = sum(usd_defl_2014, na.rm = TRUE))
finance_tree <- finance_tree %>%
group_by(crs_sector_name) %>%
mutate(pct_region = total*100/sum(total))
ggplotly(ggplot(finance_tree) +
geom_bar(aes(pct_region, crs_sector_name, fill = recipient_region),
stat= "identity", position = "fill") +
labs(title = "Chinese development finance per type and continent",
y = "", x = "Total", fill = "Region") +
theme_minimal() +
theme(title = element_text(face = "bold"),
legend.position = "bottom"))
finance %>%
group_by(year, crs_sector_name) %>%
summarise(total = sum(usd_defl_2014, na.rm = TRUE)/1000000) %>%
ungroup() %>%
group_by(crs_sector_name) %>%
mutate(totaltotal = sum(total)) %>%
filter(totaltotal > 10000 & crs_sector_name != "Unallocated / Unspecified") %>%
ggplot() +
geom_line(aes(year, total, color = crs_sector_name), size = 1, stat = "identity") +
theme_minimal() +
labs(title = "Evolution of chinese finance per most relevant sector (2000-2017)",
x = "", y = "Millions of USD (2014)", color = "Sector")  +
theme(title = element_text(face = "bold"))
finance %>%
group_by(year, crs_sector_name) %>%
summarise(total = sum(usd_defl_2014, na.rm = TRUE)/1000000) %>%
ungroup() %>%
group_by(crs_sector_name) %>%
mutate(totaltotal = sum(total)) %>%
filter(totaltotal > 10000 & crs_sector_name != "Unallocated / Unspecified") %>%
ggplot() +
geom_line(aes(year, total, color = crs_sector_name), size = 1, stat = "identity") +
theme_minimal() +
labs(title = "Evolution of chinese finance per most relevant sector (2000-2017)",
x = "", y = "Millions of USD (2014)", color = "Sector")  +
theme(plot.title = element_text(face = "bold"))
trade_debt_gdp %>%
group_by(continent, year) %>%
summarise(total = sum(total_usd, na.rm = TRUE)) %>%
ggplot() +
geom_line(aes(year, total, color = continent), stat = "identity") +
theme_minimal() +
labs(title = "Evolution of chinese trade per continent (2000-2017)",
x = "", y = "Total in USD", color = "Continent")
ggplotly(ggplot(finance_tree) +
geom_bar(aes(pct_region, crs_sector_name, fill = recipient_region),
stat= "identity", position = "fill") +
labs(title = "Chinese development finance per type and region",
y = "", x = "Total", fill = "Region") +
theme_minimal() +
theme(title = element_text(face = "bold"),
legend.position = "bottom"))
ggplotly(ggplot(finance_tree) +
geom_bar(aes(pct_region, crs_sector_name, fill = recipient_region),
stat= "identity", position = "fill") +
labs(title = "Chinese development finance per type and region",
y = "", x = "Total", fill = "Region") +
theme_minimal() +
theme(title = element_text(face = "bold")))
runApp()
