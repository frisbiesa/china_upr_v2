group_by(country) %>%
arrange(year) %>%
mutate(diff_yearc = year - lag(year),
diff_growthc = china_debt_gdp - lag(china_debt_gdp),
growth_ratec = (diff_growth / diff_year)/lag(china_debt_gdp) * 100) %>%
na.omit() %>%
mutate(five_years_debt = diff(growth_rate, lag = 5)/5) %>%
select(country, diff_support_score, five_years, five_years_debt)
africa <- africa %>%
group_by(country) %>%
arrange(year) %>%
mutate(diff_yearc = year - lag(year),
diff_growthc = china_debt_gdp - lag(china_debt_gdp),
growth_ratec = (diff_growth / diff_year)/lag(china_debt_gdp) * 100) %>%
na.omit() %>%
mutate(five_years_debt = diff(growth_rate, lag = 4)/4) %>%
select(country, diff_support_score, five_years, five_years_debt)
africa <- africa %>%
group_by(country) %>%
arrange(year) %>%
mutate(diff_yearc = year - lag(year),
diff_growthc = china_debt_gdp - lag(china_debt_gdp),
growth_ratec = (diff_growth / diff_year)/lag(china_debt_gdp) * 100) %>%
na.omit() %>%
mutate(five_years_debt = diff(growth_rate, lag = 5)/5) %>%
select(country, diff_support_score, five_years, five_years_debt)
africa <- africa %>%
group_by(country) %>%
arrange(year) %>%
mutate(diff_yearc = year - lag(year),
diff_growthc = china_debt_gdp - lag(china_debt_gdp),
growth_ratec = (diff_growth / diff_year)/lag(china_debt_gdp) * 100) %>%
na.omit() %>%
mutate(five_years_debt = diff(growth_rate, lag = 6)/6) %>%
select(country, diff_support_score, five_years, five_years_debt)
africa <- africa %>%
group_by(country) %>%
arrange(year) %>%
mutate(diff_yearc = year - lag(year),
diff_growthc = china_debt_gdp - lag(china_debt_gdp),
growth_ratec = (diff_growth / diff_year)/lag(china_debt_gdp) * 100) %>%
na.omit() %>%
mutate(five_years_debt = diff(growth_rate, lag = 3)/3) %>%
select(country, diff_support_score, five_years, five_years_debt)
un_scores$continent <- countrycode(sourcevar = un_scores$country,
origin = "country.name",
destination = "continent")
View(debt)
debt_gdp <- debt %>%
select(country, year, china_debt_gdp)
un_scores <- left_join(un_scores, debt_gdp, by c("country", "year"))
un_scores <- left_join(un_scores, debt_gdp, by  = c("country", "year"))
View(debt)
uh <- un_scores %>%
filter(year <= 2018 & year >= 2012) %>%
filter(trade_flow == "Import") %>%
group_by(country) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total_usd - lag(total_usd),
growth_rate = (diff_growth / diff_year)/lag(total_usd) * 100,
diff_yearc = year - lag(year),
diff_growthc = china_debt_gdp - lag(china_debt_gdp),
growth_ratec = (diff_growth / diff_year)/lag(china_debt_gdp) * 100) %>%
na.omit() %>%
mutate(five_years = diff(growth_rate, lag = 5)/5,
five_years_debt = diff(growth_rate, lag = 5)/5) %>%
select(country, diff_support_score, five_years, five_years_debt)
uh <- un_scores %>%
filter(year <= 2018 & year >= 2012) %>%
filter(trade_flow == "Import") %>%
group_by(country) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total_usd - lag(total_usd),
growth_rate = (diff_growth / diff_year)/lag(total_usd) * 100,
diff_yearc = year - lag(year),
diff_growthc = china_debt_gdp - lag(china_debt_gdp),
growth_ratec = (diff_growth / diff_year)/lag(china_debt_gdp) * 100) %>%
na.omit() %>%
mutate(five_years = diff(growth_rate, lag = 5)/5,
five_years_debt = diff(growth_ratec, lag = 5)/5) %>%
select(country, diff_support_score, five_years, five_years_debt)
uh <- un_scores %>%
filter(year <= 2018 & year >= 2012) %>%
filter(trade_flow == "Import") %>%
group_by(country) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total_usd - lag(total_usd),
growth_rate = (diff_growth / diff_year)/lag(total_usd) * 100,
diff_yearc = year - lag(year),
diff_growthc = china_debt_gdp - lag(china_debt_gdp),
growth_ratec = (diff_growthc / diff_year)/lag(china_debt_gdp) * 100) %>%
na.omit() %>%
mutate(five_years = diff(growth_rate, lag = 5)/5,
five_years_debt = diff(growth_ratec, lag = 5)/5) %>%
select(country, diff_support_score, five_years, five_years_debt)
uh <- un_scores %>%
filter(year <= 2018 & year >= 2012) %>%
filter(trade_flow == "Import") %>%
group_by(country) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total_usd - lag(total_usd),
growth_rate = (diff_growth / diff_year)/lag(total_usd) * 100,
diff_yearc = year - lag(year),
diff_growthc = china_debt_gdp - lag(china_debt_gdp),
growth_ratec = (diff_growthc / diff_year)/lag(china_debt_gdp) * 100) %>%
na.omit() %>%
mutate(five_years = diff(growth_rate, lag = 5)/5,
five_years_debt = diff(growth_ratec, lag = 5)/5) %>%
select(country, diff_support_score, five_years, five_years_debt)
uh <- un_scores %>%
filter(year <= 2018 & year >= 2012) %>%
filter(trade_flow == "Import") %>%
group_by(country) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total_usd - lag(total_usd),
growth_rate = (diff_growth / diff_year)/lag(total_usd) * 100,
diff_yearc = year - lag(year),
diff_growthc = china_debt_gdp - lag(china_debt_gdp),
growth_ratec = (diff_growthc / diff_year)/lag(china_debt_gdp) * 100) %>%
na.omit() %>%
mutate(five_years = diff(growth_rate, lag = 5)/5,
five_years_debt = diff(growth_ratec, lag = 5)/5) %>%
select(country, diff_support_score, five_years, five_years_debt)
uh <- un_scores %>%
filter(year <= 2018 & year >= 2012) %>%
filter(trade_flow == "Import") %>%
group_by(country) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total_usd - lag(total_usd),
growth_rate = (diff_growth / diff_year)/lag(total_usd) * 100,
diff_yearc = year - lag(year),
diff_growthc = china_debt_gdp - lag(china_debt_gdp),
growth_ratec = (diff_growthc / diff_year)/lag(china_debt_gdp) * 100) %>%
na.omit() %>%
mutate(five_years = diff(growth_rate, lag = 5)/5,
five_years_debt = diff(growth_ratec, lag = 5)/5) %>%
select(country, diff_support_score, five_years, five_years_debt)
uh <- un_scores %>%
filter(year <= 2018 & year >= 2012) %>%
filter(trade_flow == "Import") %>%
group_by(country) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total_usd - lag(total_usd),
growth_rate = (diff_growth / diff_year)/lag(total_usd) * 100,
diff_yearc = year - lag(year),
diff_growthc = china_debt_gdp - lag(china_debt_gdp),
growth_ratec = (diff_growthc / diff_year)/lag(china_debt_gdp) * 100) %>%
na.omit() #%>%
View(uh)
uh <- un_scores %>%
filter(year <= 2018 & year >= 2012) %>%
filter(trade_flow == "Import") %>%
group_by(country) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total_usd - lag(total_usd),
growth_rate = (diff_growth / diff_year)/lag(total_usd) * 100,
diff_yearc = year - lag(year),
diff_growthc = china_debt_gdp - lag(china_debt_gdp),
growth_ratec = (diff_growthc / diff_year)/lag(china_debt_gdp) * 100) #%>%
uh <- un_scores %>%
filter(year <= 2018 & year >= 2012) %>%
filter(trade_flow == "Import") %>%
group_by(country) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total_usd - lag(total_usd),
growth_rate = (diff_growth / diff_year)/lag(total_usd) * 100,
diff_yearc = year - lag(year),
diff_growthc = china_debt_gdp - lag(china_debt_gdp),
growth_ratec = (diff_growthc / diff_year)/lag(china_debt_gdp) * 100) %>%
na.omit() %>%
mutate(five_years = diff(growth_rate, lag = 5)/5,
five_years_debt = diff(growth_ratec, lag = 5)/5) %>%
select(country, diff_support_score, five_years, five_years_debt)
uh <- un_scores %>%
filter(year <= 2018 & year >= 2012) %>%
filter(trade_flow == "Import") %>%
group_by(country) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total_usd - lag(total_usd),
growth_rate = (diff_growth / diff_year)/lag(total_usd) * 100,
diff_yearc = year - lag(year),
diff_growthc = china_debt_gdp - lag(china_debt_gdp),
growth_ratec = (diff_growthc / diff_yearc)/lag(china_debt_gdp) * 100) %>%
na.omit() %>%
mutate(five_years = diff(growth_rate, lag = 5)/5,
five_years_debt = diff(growth_ratec, lag = 5)/5) %>%
select(country, diff_support_score, five_years, five_years_debt)
uh <- un_scores %>%
filter(year <= 2018 & year >= 2012) %>%
filter(trade_flow == "Import") %>%
group_by(country) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total_usd - lag(total_usd),
growth_rate = (diff_growth / diff_year)/lag(total_usd) * 100,
diff_yearc = year - lag(year),
diff_growthc = china_debt_gdp - lag(china_debt_gdp),
growth_ratec = (diff_growthc / diff_yearc)/lag(china_debt_gdp) * 100) %>%
na.omit() %>%
mutate(five_years = diff(growth_rate, lag = 4)/4,
five_years_debt = diff(growth_ratec, lag = 4)/4) %>%
select(country, diff_support_score, five_years, five_years_debt)
uh <- un_scores %>%
filter(year <= 2018 & year >= 2012) %>%
filter(trade_flow == "Import") %>%
group_by(country) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total_usd - lag(total_usd),
growth_rate = (diff_growth / diff_year)/lag(total_usd) * 100,
diff_yearc = year - lag(year),
diff_growthc = china_debt_gdp - lag(china_debt_gdp),
growth_ratec = (diff_growthc / diff_yearc)/lag(china_debt_gdp) * 100) %>%
na.omit() %>%
mutate(five_years = diff(growth_rate, lag = 5)/5,
five_years_debt = diff(growth_ratec, lag = 5)/5) %>%
select(country, diff_support_score, five_years, five_years_debt)
uh <- un_scores %>%
filter(year <= 2018 & year >= 2012) %>%
filter(trade_flow == "Import") %>%
group_by(country) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total_usd - lag(total_usd),
growth_rate = (diff_growth / diff_year)/lag(total_usd) * 100,
diff_yearc = year - lag(year),
diff_growthc = china_debt_gdp - lag(china_debt_gdp),
growth_ratec = (diff_growthc / diff_yearc)/lag(china_debt_gdp) * 100) %>%
na.omit() #%>%
View(debt)
uh <- un_scores %>%
filter(year <= 2018 & year >= 2012) %>%
filter(trade_flow == "Import") %>%
group_by(country) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total_usd - lag(total_usd),
growth_rate = (diff_growth / diff_year)/lag(total_usd) * 100,
diff_yearc = year - lag(year),
diff_growthc = china_debt_gdp - lag(china_debt_gdp),
growth_ratec = (diff_growthc / diff_yearc)/lag(china_debt_gdp) * 100) #%>%
uh <- un_scores %>%
filter(year <= 2018 & year >= 2012) %>%
filter(trade_flow == "Import") %>%
group_by(country) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total_usd - lag(total_usd),
growth_rate = (diff_growth / diff_year)/lag(total_usd) * 100,
diff_yearc = year - lag(year),
diff_growthc = china_debt_gdp - lag(china_debt_gdp),
growth_ratec = (diff_growthc / diff_yearc)/lag(china_debt_gdp) * 100) %>%
filter(!is.na(growth_rate))# %>%
uh <- un_scores %>%
filter(year <= 2018 & year >= 2012) %>%
filter(trade_flow == "Import") %>%
group_by(country) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total_usd - lag(total_usd),
growth_rate = (diff_growth / diff_year)/lag(total_usd) * 100) %>%
na.omit() %>%
mutate(five_years = diff(growth_rate, lag = 5)/5)
uh <- un_scores %>%
filter(year <= 2018 & year >= 2012) %>%
filter(trade_flow == "Import") %>%
group_by(country) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total_usd - lag(total_usd),
growth_rate = (diff_growth / diff_year)/lag(total_usd) * 100) #%>%
diff(uh$growth_rate, lag = 5)
diff(uh$growth_rate, lag = 6)
diff(uh$growth_rate, lag = 4)
diff(uh$growth_rate, lag = 5)
uh <- un_scores %>%
filter(year <= 2018 & year >= 2012) %>%
filter(trade_flow == "Import") %>%
group_by(country) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total_usd - lag(total_usd),
growth_rate = (diff_growth / diff_year)/lag(total_usd) * 100) %>%
mutate(five_years = diff(growth_rate, lag = 5)/5)
uh <- un_scores %>%
filter(year <= 2018 & year >= 2012) %>%
filter(trade_flow == "Import") %>%
group_by(country) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total_usd - lag(total_usd),
growth_rate = (diff_growth / diff_year)/lag(total_usd) * 100) %>%
na.omit() %>%
mutate(five_years = diff(growth_rate, lag = 5)/5)
View(uru)
uru <- un_scores %>%
filter(country == "Uruguay")
View(uru)
uru %>%
filter(year <= 2018 & year >= 2012) %>%
filter(trade_flow == "Import") %>%
group_by(country) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total_usd - lag(total_usd),
growth_rate = (diff_growth / diff_year)/lag(total_usd) * 100) %>%
na.omit() %>%
mutate(five_years = diff(growth_rate, lag = 5)/5)
uru %>%
filter(year <= 2018 & year >= 2012) %>%
filter(trade_flow == "Import") %>%
group_by(country) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total_usd - lag(total_usd),
growth_rate = (diff_growth / diff_year)/lag(total_usd) * 100) #%>%
uru %>%
filter(year <= 2018 & year >= 2012) %>%
filter(trade_flow == "Import") %>%
group_by(country) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total_usd - lag(total_usd),
growth_rate = (diff_growth / diff_year)/lag(total_usd) * 100) %>%
mutate(five_years = diff(growth_rate, lag = 5)/5)
uru %>%
filter(year <= 2018 & year >= 2012) %>%
filter(trade_flow == "Import") %>%
group_by(country) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total_usd - lag(total_usd),
growth_rate = (diff_growth / diff_year)/lag(total_usd) * 100) #%>%
uru %>%
filter(year <= 2018 & year >= 2012) %>%
filter(trade_flow == "Import") %>%
group_by(country) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total_usd - lag(total_usd),
growth_rate = (diff_growth / diff_year)/lag(total_usd) * 100) %>%
na.omit() %>%
mutate(five_years = diff(growth_rate, lag = 5)/5)
View(saa)
africa <- africa %>%
uru %>%
filter(year <= 2018 & year >= 2012) %>%
filter(trade_flow == "Import") %>%
group_by(country) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total_usd - lag(total_usd),
growth_rate = (diff_growth / diff_year)/lag(total_usd) * 100) %>%
filter(!is.na(diff_growth)) %>%
mutate(five_years = diff(growth_rate, lag = 5)/5)
uru %>%
filter(year <= 2018 & year >= 2012) %>%
filter(trade_flow == "Import") %>%
group_by(country) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total_usd - lag(total_usd),
growth_rate = (diff_growth / diff_year)/lag(total_usd) * 100) %>%
filter(!is.na(diff_growth)) %>%
mutate(five_years = diff(growth_rate, lag = 5)/5)
uru %>%
filter(year <= 2018 & year >= 2012) %>%
filter(trade_flow == "Import") %>%
group_by(country) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total_usd - lag(total_usd),
growth_rate = (diff_growth / diff_year)/lag(total_usd) * 100) %>%
filter(!is.na(diff_growth)) %>%
mutate(five_years = diff(growth_rate, lag = 5)/5)
asdf <- uru %>%
filter(year <= 2018 & year >= 2012) %>%
filter(trade_flow == "Import") %>%
group_by(country) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total_usd - lag(total_usd),
growth_rate = (diff_growth / diff_year)/lag(total_usd) * 100) %>%
filter(!is.na(diff_growth)) %>%
mutate(five_years = diff(growth_rate, lag = 5)/5)
View(asdf)
five_year_trade <- un_scores %>%
filter(year <= 2018 & year >= 2012) %>%
filter(trade_flow == "Import") %>%
group_by(country) %>%
arrange(year) %>%
mutate(diff_year = year - lag(year),
diff_growth = total_usd - lag(total_usd),
growth_rate = (diff_growth / diff_year)/lag(total_usd) * 100) %>%
filter(!is.na(diff_growth)) %>%
mutate(five_years = diff(growth_rate, lag = 5)/5)
mutate(five_years = diff(growth_rate, lag = 4)/4)
mutate(five_years = diff(growth_ratec, lag = 4)/4)
four_year_debt <- un_scores %>%
filter(year <= 2017 & year >= 2012) %>%
filter(trade_flow == "Import") %>%
group_by(country) %>%
arrange(year) %>%
mutate(diff_yearc = year - lag(year),
diff_growthc = china_debt_gdp - lag(china_debt_gdp),
growth_ratec = (diff_growthc / diff_yearc)/lag(china_debt_gdp) * 100) %>%
filter(!is.na(diff_growthc)) %>%
mutate(five_years = diff(growth_ratec, lag = 4)/4)
View(four_year_debt)
four_year_debt <- un_scores %>%
filter(year <= 2017 & year >= 2012) %>%
filter(trade_flow == "Import") %>%
group_by(country) %>%
arrange(year) %>%
mutate(diff_yearc = year - lag(year),
diff_growthc = china_debt_gdp - lag(china_debt_gdp),
growth_ratec = (diff_growthc / diff_yearc)/lag(china_debt_gdp) * 100) %>%
filter(!is.na(diff_growthc)) %>%
mutate(four_years = diff(growth_ratec, lag = 4)/4)
africa <- left_join(five_year_trade, four_year_debt, by = c("country", "year")) %>%
select(year, country, five_years, four_years)
View(africa)
africa <- left_join(five_year_trade, four_year_debt, by = c("country", "year")) %>%
select(year, country, five_years, four_years, diff_support_score)
View(four_year_debt)
View(five_year_trade)
africa <- left_join(five_year_trade, four_year_debt, by = c("country", "year")) %>%
select(year, country, five_years, four_years, diff_support_score)
View(four_year_debt)
View(five_year_trade)
africa <- left_join(five_year_trade, four_year_debt, by = c("country", "year")) %>%
select(diff_support_score, year, country, five_years, four_years)
four_year_debt <- un_scores %>%
filter(year <= 2017 & year >= 2012) %>%
filter(trade_flow == "Import") %>%
group_by(country) %>%
arrange(year) %>%
mutate(diff_yearc = year - lag(year),
diff_growthc = china_debt_gdp - lag(china_debt_gdp),
growth_ratec = (diff_growthc / diff_yearc)/lag(china_debt_gdp) * 100) %>%
filter(!is.na(diff_growthc)) %>%
mutate(four_years = diff(growth_ratec, lag = 4)/4)
africa <- left_join(five_year_trade, four_year_debt, by = c("country", "year"))
View(africa)
four_year_debt <- un_scores %>%
filter(year <= 2017 & year >= 2012) %>%
filter(trade_flow == "Import") %>%
group_by(country) %>%
arrange(year) %>%
mutate(diff_yearc = year - lag(year),
diff_growthc = china_debt_gdp - lag(china_debt_gdp),
growth_ratec = (diff_growthc / diff_yearc)/lag(china_debt_gdp) * 100) %>%
filter(!is.na(diff_growthc)) %>%
mutate(four_years = diff(growth_ratec, lag = 4)/4) %>%
select(year, country, four_years)
four_year_debt <- un_scores %>%
filter(year <= 2017 & year >= 2012) %>%
filter(trade_flow == "Import") %>%
group_by(country) %>%
arrange(year) %>%
mutate(diff_yearc = year - lag(year),
diff_growthc = china_debt_gdp - lag(china_debt_gdp),
growth_ratec = (diff_growthc / diff_yearc)/lag(china_debt_gdp) * 100) %>%
filter(!is.na(diff_growthc)) %>%
mutate(four_years = diff(growth_ratec, lag = 4)/4) %>%
select(year, country, four_years)
View(africa)
africa <- left_join(five_year_trade, four_year_debt, by = c("country", "year")) %>%
select(diff_support_score, year, country, five_years, four_years) %>%
filter(continent == "Africa")
africa <- left_join(five_year_trade, four_year_debt, by = c("country", "year")) %>%
select(diff_support_score, year, country, five_years, four_years, continent) %>%
filter(continent == "Africa")
africa <- left_join(five_year_trade, four_year_debt, by = c("country", "year")) %>%
select(year, country, five_years, four_years, diff_support_score, continent) %>%
filter(continent == "Africa")
summary(lm(africa$diff_support_score ~ africa$five_years + africa$five_years))
summary(lm(africa$diff_support_score ~ africa$five_years + africa$five_years))
africa %>%
ggplot() +
geom_point(aes(log(five_years), diff_support_score), stat = "identity")  +
geom_smooth(aes(log(five_years), diff_support_score))
africa %>%
ggplot() +
geom_point(aes(log(five_years), diff_support_score), stat = "identity")
summary(lm(africa$diff_support_score ~ africa$five_years + africa$four_years))
test <- left_join(five_year_trade, four_year_debt, by = c("country", "year")) %>%
select(year, country, five_years, four_years, diff_support_score, continent)
test %>%
ggplot() +
geom_point(aes(log(five_years), diff_support_score), stat = "identity")  +
geom_smooth(aes(log(five_years), diff_support_score))
test %>%
ggplot() +
geom_point(aes(log(four_years), diff_support_score), stat = "identity")  +
geom_smooth(aes(log(four_years), diff_support_score))
africa %>%
ggplot() +
geom_point(aes(log(five_years), diff_support_score), stat = "identity")  +
geom_smooth(aes(log(five_years), diff_support_score))
summary(lm(test$diff_support_score ~ test$five_years))
summary(lm(africa$diff_support_score ~ africa$five_years))
